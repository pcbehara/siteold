function PaymentMethod(e,t,a,n,o){this.name=e,this.creditCard=t,this.cardType=a,this.cardCvv=n,this.cardHolderName=o}function PaymentMethods(){this.length=0,this.methods=new Array}PaymentMethod.prototype.getName=function(){return this.name},PaymentMethod.prototype.getCreditCard=function(){return this.creditCard},PaymentMethod.prototype.getCardType=function(){return this.cardType},PaymentMethod.prototype.getCardCvv=function(){return this.cardCvv},PaymentMethod.prototype.getCardHolderName=function(){return this.cardHolderName},PaymentMethods.prototype.Add=function(e){this.methods[this.length]=e,this.length=this.length+1},PaymentMethods.prototype.Find=function(e){for(var t=0;t<this.length;t++)if(this.methods[t].name==e)return this.methods[t];return null};var stripeResponseHandler=function(e,t){OSM.jQuery(function(e){var a=e("#os_form");if(t.error)"card_error"==t.error.type&&"undefined"!=typeof osmStripeErrors&&osmStripeErrors[t.error.code]&&(t.error.message=osmStripeErrors[t.error.code]),alert(t.error.message),a.find("#btn-submit").prop("disabled",!1);else{var n=t.id;e("#x_card_num").val(""),e("#x_card_code").val(""),e("#card_holder_name").val(""),a.append(e('<input type="hidden" name="stripeToken" />').val(n)),a.get(0).submit()}})};function stripeTokenHandler(e){var t=document.getElementById("os_form"),a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name","stripeToken"),a.setAttribute("value",e.id),t.appendChild(a),t.submit()}OSM.jQuery(function(e){OSMVALIDATEFORM=function(t){e(t).validationEngine("attach",{onValidationComplete:function(e,t){return 1==t&&(e.on("submit",function(e){e.preventDefault()}),!0)}})},changePaymentMethod=function(){updatePaymentMethod(),1==document.os_form.show_payment_fee.value&&calculateSubscriptionFee()},updatePaymentMethod=function(){document.os_form;if(e("input:radio[name^=payment_method]").length)var t=e("input:radio[name^=payment_method]:checked").val();else t=e("input[name^=payment_method]").val();method=methods.Find(t),method&&(method.getCreditCard()?(e("#tr_card_number").show(),e("#tr_exp_date").show(),e("#tr_cvv_code").show(),method.getCardHolderName(),e("#tr_card_holder_name").show()):(e("#tr_card_number").hide(),e("#tr_exp_date").hide(),e("#tr_cvv_code").hide(),e("#tr_card_holder_name").hide()),"os_squareup"==t?e("#sq_field_zipcode").show():e("#sq_field_zipcode").hide(),"undefined"!=typeof stripe&&(0==t.indexOf("os_stripe")?e("#stripe-card-form").show():e("#stripe-card-form").hide()))},calculateSubscriptionFee=function(){if(e("input:radio[name^=payment_method]").length)var t=e("input:radio[name^=payment_method]:checked").val();else t=e("input[name^=payment_method]").val();void 0!==t&&(e("#btn-submit").attr("disabled","disabled"),e("#ajax-loading-animation").show(),e.ajax({type:"POST",url:siteUrl+"index.php?option=com_osmembership&task=register.calculate_subscription_fee&payment_method="+t+langLinkForAjax,data:e("#os_form input[name='plan_id'], #os_form input[name='coupon_code'], #os_form select[name='country'], #os_form select[name='state'], #os_form input.taxable[type='text'], #os_form input[name='coupon_code'], #os_form input[name='act'], #os_form input[name='renew_option_id'], #os_form input[name='upgrade_option_id'], #os_form .payment-calculation input[type='text'], #os_form .payment-calculation input[type='checkbox']:checked, #os_form .payment-calculation input[type='radio']:checked, #os_form .payment-calculation select"),dataType:"json",success:function(t,a,n){e("#btn-submit").removeAttr("disabled"),e("#ajax-loading-animation").hide(),e("#amount").length&&(e("#amount").val(t.amount),e("#discount_amount").length&&e("#discount_amount").val(t.discount_amount),e("#tax_amount").length&&e("#tax_amount").val(t.tax_amount),e("#payment_processing_fee").length&&e("#payment_processing_fee").val(t.payment_processing_fee),e("#gross_amount").length&&e("#gross_amount").val(t.gross_amount)),e("#payment-terms").length&&(e("#payment-terms").html(t.payment_terms),e("#trial_amount").length&&(e("#trial_amount").val(t.trial_amount),e("#trial_discount_amount").val(t.trial_discount_amount),t.trial_discount_amount>0?e("#trial_discount_amount_container").show():e("#trial_discount_amount_container").hide(),e("#trial_tax_amount").val(t.trial_tax_amount),t.trial_tax_amount>0?e("#trial_tax_amount_container").show():e("#trial_tax_amount_container").hide(),e("#trial_payment_processing_fee").val(t.trial_payment_processing_fee),t.trial_payment_processing_fee>0?e("#trial_payment_processing_fee_container").show():e("#trial_payment_processing_fee_container").hide(),e("#trial_gross_amount").val(t.trial_gross_amount),t.trial_discount_amount>0||t.trial_tax_amount>0||t.trial_payment_processing_fee>0?e("#trial_gross_amount_container").show():e("#trial_gross_amount_container").hide()),e("#regular_amount").val(t.regular_amount),e("#regular_discount_amount").val(t.regular_discount_amount),t.regular_discount_amount>0?e("#regular_discount_amount_container").show():e("#regular_discount_amount_container").hide(),e("#regular_tax_amount").val(t.regular_tax_amount),t.regular_tax_amount>0?e("#regular_tax_amount_container").show():e("#regular_tax_amount_container").hide(),e("#regular_payment_processing_fee").val(t.regular_payment_processing_fee),t.regular_payment_processing_fee>0?e("#regular_payment_processing_fee_container").show():e("#regular_payment_processing_fee_container").hide(),e("#regular_gross_amount").val(t.regular_gross_amount),t.regular_discount_amount>0||t.regular_tax_amount>0||t.regular_payment_processing_fee>0?e("#regular_gross_amount_container").show():e("#regular_gross_amount_container").hide()),e("#vat_country_code")&&("GR"==t.country_code?e("#vat_country_code").text("EL"):e("#vat_country_code").text(t.country_code));var o=e("input[name^=vat_number_field]").val();o&&(1==t.show_vat_number_field?e("#field_"+o).show():e("#field_"+o).hide()),0==t.show_payment_information?e(".payment_information").css("display","none"):(e(".payment_information").css("display",""),updatePaymentMethod()),1==t.coupon_valid?e("#coupon_validate_msg").hide():e("#coupon_validate_msg").show(),1==t.vatnumber_valid?e("#vatnumber_validate_msg").hide():e("#vatnumber_validate_msg").show()},error:function(e,t,a){alert(t)}}))},showHideDependFields=function(t,a,n){masterFieldsSelector=".master-field input[type='checkbox']:checked, .master-field input[type='radio']:checked, .master-field select",e("#btn-submit").attr("disabled","disabled"),e("#ajax-loading-animation").show(),e.ajax({type:"POST",url:siteUrl+"index.php?option=com_osmembership&task=register.get_depend_fields_status&field_id="+t+langLinkForAjax,data:e(masterFieldsSelector),dataType:"json",success:function(t,a,n){e("#btn-submit").removeAttr("disabled"),e("#ajax-loading-animation").hide();for(var o=t.hide_fields.split(","),r=t.show_fields.split(","),i=0;i<o.length;i++)e("#"+o[i]).hide();for(i=0;i<r.length;i++)e("#"+r[i]).show();calculateSubscriptionFee()},error:function(e,t,a){alert(t)}})},buildStateField=function(t,a,n){if(e("#"+t).length&&e("#"+t).is("select")){if(e("#"+a).length)var o=e("#"+a).val();else o="";e.ajax({type:"GET",url:siteUrl+"index.php?option=com_osmembership&task=register.get_states&country_name="+o+"&field_name="+t+"&state_name="+n+langLinkForAjax,success:function(n){e("#field_"+t+" .controls").length?e("#field_"+t+" .controls").html(n):e("#field_"+t+" .col-md-9").html(n),"undefined"!=typeof taxStateCountries&&"state"==t&&taxStateCountries[0]&&e("#state").change(function(){if(e("#"+a).length)var t=e("#country").val();else t=e("#default_country").val();t&&-1!=e.inArray(t,taxStateCountries)&&calculateSubscriptionFee()})},error:function(e,t,a){alert(t)}}),e("#"+a).length&&e("#"+a).change(function(){e.ajax({type:"GET",url:siteUrl+"index.php?option=com_osmembership&task=register.get_states&country_name="+e(this).val()+"&field_name="+t+"&state_name="+n+langLinkForAjax,success:function(a){e("#field_"+t+" .controls").length?e("#field_"+t+" .controls").html(a):e("#field_"+t+" .col-md-9").html(a),"undefined"!=typeof taxStateCountries&&"state"==t&&taxStateCountries[0]&&e("#state").change(function(){if(e("#country").length)var t=e("#country").val();else t="";t&&-1!=e.inArray(t,taxStateCountries)&&calculateSubscriptionFee()})},error:function(e,t,a){alert(t)}}),0!=(paymentMethod=e("input[name^=country_base_tax]").val())&&calculateSubscriptionFee()})}else e("#"+a).length&&e("#"+a).change(function(){0!=(paymentMethod=e("input[name^=country_base_tax]").val())&&calculateSubscriptionFee()})}});